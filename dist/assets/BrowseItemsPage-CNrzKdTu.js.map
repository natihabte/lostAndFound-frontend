{"version":3,"file":"BrowseItemsPage-CNrzKdTu.js","sources":["../../src/pages/BrowseItemsPage.jsx"],"sourcesContent":["import React, { useState, useMemo, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Filter, Grid, List, SortAsc, SortDesc, X } from 'lucide-react';\r\nimport ModernItemCard from '../components/ModernItemCard';\r\nimport UniversalSearchBar, { filterItemsBySearch } from '../components/UniversalSearchBar';\r\nimport { NoItemsFound, LoadingState, CommunityStats } from '../components/EmptyStates';\r\n\r\nconst BrowseItemsPage = ({ \r\n  items = [], \r\n  loading, \r\n  isLoggedIn, \r\n  userRole, \r\n  onClaimItem, \r\n  onDeleteItem, \r\n  onContactOwner,\r\n  onViewDetails,\r\n  searchTerm = '',\r\n  setSearchTerm,\r\n  selectedCategory = 'all',\r\n  setSelectedCategory,\r\n  selectedStatus = 'all',\r\n  setSelectedStatus,\r\n  setCurrentPage,\r\n  handleClaimItem,\r\n  darkMode,\r\n  onRefetch\r\n}) => {\r\n  const [selectedLocation, setSelectedLocation] = useState('all');\r\n  const [viewMode, setViewMode] = useState('grid');\r\n  const [sortBy, setSortBy] = useState('date');\r\n  const [sortOrder, setSortOrder] = useState('desc');\r\n  const [localSearchTerm, setLocalSearchTerm] = useState(searchTerm || '');\r\n  const { t, i18n } = useTranslation();\r\n  const categories = ['electronic', 'clothing', 'accessory', 'document', 'book', 'other'];\r\n\r\n  // Extract unique locations from items (memoized)\r\n  const locations = useMemo(() => \r\n    [...new Set(items.map(item => item.location))].filter(Boolean),\r\n    [items]\r\n  );\r\n\r\n  // Trigger API refetch when filters change\r\n  useEffect(() => {\r\n    if (onRefetch) {\r\n      onRefetch({\r\n        search: '',\r\n        category: selectedCategory,\r\n        status: selectedStatus\r\n      });\r\n    }\r\n  }, [selectedCategory, selectedStatus]);\r\n\r\n  // Client-side filtering with search\r\n  const filteredAndSortedItems = useMemo(() => {\r\n    // First apply search filter\r\n    const searchFiltered = filterItemsBySearch(items, localSearchTerm);\r\n    \r\n    const filtered = searchFiltered.filter(item => {\r\n      // Category filter\r\n      const matchesCategory = selectedCategory === 'all' || item.category === selectedCategory;\r\n      \r\n      // Status filter  \r\n      const matchesStatus = selectedStatus === 'all' || item.status === selectedStatus;\r\n      \r\n      // Location filter (client-side only)\r\n      const matchesLocation = selectedLocation === 'all' || \r\n        (item.location && item.location === selectedLocation);\r\n      \r\n      return matchesCategory && matchesStatus && matchesLocation;\r\n    });\r\n    \r\n    // Apply sorting\r\n    return filtered.sort((a, b) => {\r\n      let aValue, bValue;\r\n      \r\n      switch (sortBy) {\r\n        case 'title':\r\n          aValue = a.title.toLowerCase();\r\n          bValue = b.title.toLowerCase();\r\n          break;\r\n        case 'location':\r\n          aValue = a.location.toLowerCase();\r\n          bValue = b.location.toLowerCase();\r\n          break;\r\n        case 'category':\r\n          aValue = a.category.toLowerCase();\r\n          bValue = b.category.toLowerCase();\r\n          break;\r\n        case 'date':\r\n        default:\r\n          aValue = new Date(a.date || a.createdAt);\r\n          bValue = new Date(b.date || b.createdAt);\r\n          break;\r\n      }\r\n      \r\n      if (sortOrder === 'asc') {\r\n        return aValue > bValue ? 1 : -1;\r\n      } else {\r\n        return aValue < bValue ? 1 : -1;\r\n      }\r\n    });\r\n  }, [items, localSearchTerm, selectedCategory, selectedStatus, selectedLocation, sortBy, sortOrder]);\r\n\r\n  const clearAllFilters = () => {\r\n    setLocalSearchTerm('');\r\n    if (setSearchTerm) setSearchTerm('');\r\n    if (setSelectedCategory) setSelectedCategory('all');\r\n    if (setSelectedStatus) setSelectedStatus('all');\r\n    setSelectedLocation('all');\r\n    // Trigger refetch with cleared filters\r\n    if (onRefetch) {\r\n      setTimeout(() => onRefetch({ search: '', category: 'all', status: 'all' }), 100);\r\n    }\r\n  };\r\n\r\n  // Calculate stats based on filtered results\r\n  const stats = useMemo(() => ({\r\n    totalItems: filteredAndSortedItems.length,\r\n    totalLost: filteredAndSortedItems.filter(item => item.status === 'Lost').length,\r\n    totalFound: filteredAndSortedItems.filter(item => item.status === 'Found').length,\r\n    reunited: filteredAndSortedItems.filter(item => item.claimed).length,\r\n    activeUsers: Math.floor(filteredAndSortedItems.length * 0.7) // Approximate\r\n  }), [filteredAndSortedItems]);\r\n\r\n  if (loading) {\r\n    return <LoadingState message=\"Loading items...\" darkMode={darkMode} />;\r\n  }\r\n\r\n  return (\r\n    <div className={`min-h-screen ${darkMode ? 'bg-gray-900' : 'bg-gray-50'}`}>\r\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\r\n        {/* Page Header */}\r\n        <div className=\"mb-8\">\r\n          <h1 className={`text-3xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'} mb-2`}>{t('pages.browseItems')}</h1>\r\n          <p className={`${darkMode ? 'text-gray-300' : 'text-gray-600'}`}>\r\n            {t('pages.browseSubtitle')}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Search Bar */}\r\n        <div className=\"mb-8\">\r\n          <UniversalSearchBar\r\n            value={localSearchTerm}\r\n            onChange={setLocalSearchTerm}\r\n            placeholder={t('search.placeholder')}\r\n            className=\"max-w-2xl mx-auto\"\r\n            darkMode={darkMode}\r\n          />\r\n        </div>\r\n\r\n        {/* Community Stats */}\r\n        <CommunityStats \r\n          stats={stats} \r\n          hasFilters={localSearchTerm || selectedCategory !== 'all' || selectedStatus !== 'all' || selectedLocation !== 'all'}\r\n          darkMode={darkMode}\r\n        />\r\n\r\n        {/* Items Display */}\r\n        {filteredAndSortedItems.length === 0 ? (\r\n          <NoItemsFound \r\n            hasFilters={localSearchTerm || selectedCategory !== 'all' || selectedStatus !== 'all' || selectedLocation !== 'all'}\r\n            searchTerm={localSearchTerm}\r\n            onClearFilters={clearAllFilters}\r\n            darkMode={darkMode}\r\n          />\r\n        ) : (\r\n          <div className={\r\n            viewMode === 'grid' \r\n              ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6'\r\n              : 'space-y-4'\r\n          }>\r\n            {filteredAndSortedItems.map(item => (\r\n              <ModernItemCard\r\n                key={`${item._id || item.id}-${i18n.language}`}\r\n                item={item}\r\n                isLoggedIn={isLoggedIn}\r\n                userRole={userRole}\r\n                onViewDetails={onViewDetails}\r\n                onClaim={onClaimItem}\r\n                onDelete={onDeleteItem}\r\n                onContact={onContactOwner}\r\n                viewMode={viewMode}\r\n                darkMode={darkMode}\r\n              />\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Load More Button (for pagination if needed) */}\r\n        {filteredAndSortedItems.length > 0 && filteredAndSortedItems.length >= 20 && (\r\n          <div className=\"text-center mt-8\">\r\n            <button className=\"px-6 py-3 bg-white border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\">\r\n              {t('actions.loadMore')}\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BrowseItemsPage;"],"names":["BrowseItemsPage","items","loading","isLoggedIn","userRole","onClaimItem","onDeleteItem","onContactOwner","onViewDetails","searchTerm","setSearchTerm","selectedCategory","setSelectedCategory","selectedStatus","setSelectedStatus","setCurrentPage","handleClaimItem","darkMode","onRefetch","selectedLocation","setSelectedLocation","useState","viewMode","setViewMode","sortBy","setSortBy","sortOrder","setSortOrder","localSearchTerm","setLocalSearchTerm","t","i18n","useTranslation","useMemo","item","useEffect","filteredAndSortedItems","filterItemsBySearch","matchesCategory","matchesStatus","matchesLocation","a","b","aValue","bValue","clearAllFilters","stats","jsx","LoadingState","jsxs","UniversalSearchBar","CommunityStats","NoItemsFound","ModernItemCard"],"mappings":"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"}